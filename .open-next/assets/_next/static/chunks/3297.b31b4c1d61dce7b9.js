(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3297],{73297:function(e){"undefined"!=typeof globalThis||"undefined"!=typeof window&&window,e.exports=(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>d});var n="custom-code-plugin__code",o="custom-code",i="custom-code:open-modal",r=function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=function(){return(s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},c=function(){return(c=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};let d=function(e,t){void 0===t&&(t={});var d,l,u,p,h,m,g,C,f,v,b,y=c({blockCustomCode:{},propsCustomCode:{},toolbarBtnCustomCode:{},placeholderScript:'<div style="pointer-events: none; padding: 10px;">\n      <svg viewBox="0 0 24 24" style="height: 30px; vertical-align: middle;">\n        <path d="M13 14h-2v-4h2m0 8h-2v-2h2M1 21h22L12 2 1 21z"></path>\n        </svg>\n      Custom code with <i>&lt;script&gt;</i> can\'t be rendered on the canvas\n    </div>',modalTitle:"Insert your code",codeViewOptions:{},buttonLabel:"Save",commandCustomCode:{}},t);void 0===(d=y)&&(d={}),u=e.Components,p=d.toolbarBtnCustomCode,u.addType("script",{view:{onRender:function(){var e=this.model,t=this.el;e.closestType(o)&&(t.innerHTML="")}}}),u.addType(o,{model:{defaults:a({name:"Custom Code",editable:!0,components:{tagName:"span",components:{type:"textnode",content:"Insert here your custom code"}}},d.propsCustomCode),init:function(){this.on("change:".concat(n),this.onCustomCodeChange);var e=this.get(n);this.components().length||this.components(e);var t=this.get("toolbar"),o="custom-code";p&&!t.filter(function(e){return e.id===o}).length&&t.unshift(a({id:o,command:i,label:'<svg viewBox="0 0 24 24">\n              <path d="M14.6 16.6l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4m-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4z"></path>\n            </svg>'},p))},onCustomCodeChange:function(){this.components(this.get(n))}},view:{events:{dblclick:"onActive"},init:function(){this.listenTo(this.model.components(),"add remove reset",this.onComponentsChange),this.onComponentsChange()},onComponentsChange:function(){var e=this;l&&clearInterval(l),l=setTimeout(function(){var t=e.model,o=e.el,i=!0;(t.get(n)||"").indexOf("<script")>=0&&d.placeholderScript&&(o.innerHTML=d.placeholderScript,i=!1),t.set({droppable:i})},0)},onActive:function(){var e=this.model;this.em.get("Commands").run(i,{target:e})}}}),h=(void 0===y?{}:y).blockCustomCode,m=e.Blocks,h&&m.add(o,r({label:"Custom Code",media:'\n      <svg viewBox="0 0 24 24">\n        <path d="M14.6 16.6l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4m-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4z"></path>\n      </svg>\n    ',category:"Extra",activate:!0,select:!0,content:{type:o}},h)),void 0===(g=y)&&(g={}),C=g.modalTitle,f=g.codeViewOptions,v=g.commandCustomCode,b=function(e,t){t instanceof HTMLElement?e.appendChild(t):t&&e.insertAdjacentHTML("beforeend",t)},e.Commands.add(i,s({keyCustomCode:n,target:null,codeViewer:null,run:function(e,t,n){void 0===n&&(n={});var o=n.target||e.getSelected();this.target=o,(null==o?void 0:o.get("editable"))&&this.showCustomCode(o,n)},stop:function(e){e.Modal.close()},showCustomCode:function(t,o){var r=o.title||C,s=t.get(n)||"",a=this.getContent();e.Modal.open({title:r,content:a}).onceClose(function(){return e.stopCommand(i)}),this.getCodeViewer().setContent(s)},getPreContent:function(){},getPostContent:function(){},getContent:function(){var t=this.getCodeViewer(),n=document.createElement("div"),o=e.getConfig("stylePrefix");return n.className="".concat(o,"custom-code"),b(n,this.getPreContent()),n.appendChild(t.getElement()),b(n,this.getPostContent()),b(n,this.getContentActions()),t.refresh(),setTimeout(function(){return t.focus()},0),n},getContentActions:function(){var t=this,n=document.createElement("button");n.setAttribute("type","button");var o=e.getConfig("stylePrefix");return n.innerHTML=g.buttonLabel,n.className="".concat(o,"btn-prim ").concat(o,"btn-import__custom-code"),n.onclick=function(){return t.handleSave()},n},handleSave:function(){var t=this.target,o=this.getCodeViewer().getContent();null==t||t.set(n,o),e.Modal.close()},getCodeViewer:function(){return this.codeViewer||(this.codeViewer=e.CodeManager.createViewer(s({codeName:"htmlmixed",theme:"hopscotch",readOnly:0},f))),this.codeViewer}},v))};return t})()}}]);