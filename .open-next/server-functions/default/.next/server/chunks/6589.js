exports.id=6589,exports.ids=[6589],exports.modules={6589:function(a){"undefined"!=typeof globalThis||"undefined"!=typeof window&&window,a.exports=(()=>{"use strict";var a={d:(b,c)=>{for(var d in c)a.o(c,d)&&!a.o(b,d)&&Object.defineProperty(b,d,{enumerable:!0,get:c[d]})},o:(a,b)=>Object.prototype.hasOwnProperty.call(a,b),r:a=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}},b={};a.r(b),a.d(b,{default:()=>j});var c="custom-code-plugin__code",d="custom-code",e="custom-code:open-modal",f=function(){return(f=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},g=function(){return(g=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},h=function(){return(h=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},i=function(){return(i=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};let j=function(a,b){void 0===b&&(b={});var j,k,l,m,n,o,p,q,r,s,t,u=i({blockCustomCode:{},propsCustomCode:{},toolbarBtnCustomCode:{},placeholderScript:'<div style="pointer-events: none; padding: 10px;">\n      <svg viewBox="0 0 24 24" style="height: 30px; vertical-align: middle;">\n        <path d="M13 14h-2v-4h2m0 8h-2v-2h2M1 21h22L12 2 1 21z"></path>\n        </svg>\n      Custom code with <i>&lt;script&gt;</i> can\'t be rendered on the canvas\n    </div>',modalTitle:"Insert your code",codeViewOptions:{},buttonLabel:"Save",commandCustomCode:{}},b);void 0===(j=u)&&(j={}),l=a.Components,m=j.toolbarBtnCustomCode,l.addType("script",{view:{onRender:function(){var a=this.model,b=this.el;a.closestType(d)&&(b.innerHTML="")}}}),l.addType(d,{model:{defaults:h({name:"Custom Code",editable:!0,components:{tagName:"span",components:{type:"textnode",content:"Insert here your custom code"}}},j.propsCustomCode),init:function(){this.on("change:".concat(c),this.onCustomCodeChange);var a=this.get(c);this.components().length||this.components(a);var b=this.get("toolbar"),d="custom-code";m&&!b.filter(function(a){return a.id===d}).length&&b.unshift(h({id:d,command:e,label:'<svg viewBox="0 0 24 24">\n              <path d="M14.6 16.6l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4m-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4z"></path>\n            </svg>'},m))},onCustomCodeChange:function(){this.components(this.get(c))}},view:{events:{dblclick:"onActive"},init:function(){this.listenTo(this.model.components(),"add remove reset",this.onComponentsChange),this.onComponentsChange()},onComponentsChange:function(){var a=this;k&&clearInterval(k),k=setTimeout(function(){var b=a.model,d=a.el,e=!0;(b.get(c)||"").indexOf("<script")>=0&&j.placeholderScript&&(d.innerHTML=j.placeholderScript,e=!1),b.set({droppable:e})},0)},onActive:function(){var a=this.model;this.em.get("Commands").run(e,{target:a})}}}),n=(void 0===u?{}:u).blockCustomCode,o=a.Blocks,n&&o.add(d,f({label:"Custom Code",media:'\n      <svg viewBox="0 0 24 24">\n        <path d="M14.6 16.6l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4m-5.2 0L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4z"></path>\n      </svg>\n    ',category:"Extra",activate:!0,select:!0,content:{type:d}},n)),void 0===(p=u)&&(p={}),q=p.modalTitle,r=p.codeViewOptions,s=p.commandCustomCode,t=function(a,b){b instanceof HTMLElement?a.appendChild(b):b&&a.insertAdjacentHTML("beforeend",b)},a.Commands.add(e,g({keyCustomCode:c,target:null,codeViewer:null,run:function(a,b,c){void 0===c&&(c={});var d=c.target||a.getSelected();this.target=d,(null==d?void 0:d.get("editable"))&&this.showCustomCode(d,c)},stop:function(a){a.Modal.close()},showCustomCode:function(b,d){var f=d.title||q,g=b.get(c)||"",h=this.getContent();a.Modal.open({title:f,content:h}).onceClose(function(){return a.stopCommand(e)}),this.getCodeViewer().setContent(g)},getPreContent:function(){},getPostContent:function(){},getContent:function(){var b=this.getCodeViewer(),c=document.createElement("div"),d=a.getConfig("stylePrefix");return c.className="".concat(d,"custom-code"),t(c,this.getPreContent()),c.appendChild(b.getElement()),t(c,this.getPostContent()),t(c,this.getContentActions()),b.refresh(),setTimeout(function(){return b.focus()},0),c},getContentActions:function(){var b=this,c=document.createElement("button");c.setAttribute("type","button");var d=a.getConfig("stylePrefix");return c.innerHTML=p.buttonLabel,c.className="".concat(d,"btn-prim ").concat(d,"btn-import__custom-code"),c.onclick=function(){return b.handleSave()},c},handleSave:function(){var b=this.target,d=this.getCodeViewer().getContent();null==b||b.set(c,d),a.Modal.close()},getCodeViewer:function(){return this.codeViewer||(this.codeViewer=a.CodeManager.createViewer(g({codeName:"htmlmixed",theme:"hopscotch",readOnly:0},r))),this.codeViewer}},s))};return b})()}};